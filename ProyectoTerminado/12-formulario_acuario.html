<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Formulario</title>
    <script type="text/javascript" src="12-formulario_acuario.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" type="text/css" href="12-formulario_acuario.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Additional CSS for enhanced styling */
        .question-group {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .question-group:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
        }
        
        input[type="radio"] {
            margin-right: 8px;
        }
        
        .text-input {
            margin-top: 10px;
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid #b2e1fd;
            font-family: "Poppins", sans-serif;
            font-size: 15px;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }
        
        .text-input:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .form-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .form-header h3 {
            color: #b2e1fd;
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .form-header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95em;
        }
        
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 600px) {
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .buttons-container {
                flex-direction: column;
                align-items: center;
            }
            
            .question-group {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <header>
                <a href="1-indexPag.html">
                    <img src="imgs/flecha.png" alt="Flecha" id="flecha">
                </a>
                <h1><span>Cuestionario diagnóstico</span></h1>
            </header>
        </div>
        
        <div class="body">
            <div class="form-header">
                <h3>NOTA:</h3>
                <p>En caso de no conocer la respuesta, escribe: No lo sé.</p>
            </div>
            
            <form name="formulario">
                <div class="question-group">
                    <label for="respuesta1">1. ¿Has escuchado hablar del Clearwater Marine Aquarium antes?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta1" id="respuesta1_si" value="Sí">
                            <label for="respuesta1_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta1" id="respuesta1_no" value="No">
                            <label for="respuesta1_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <label for="respuesta2">2. ¿Sabes en qué país se encuentra ubicado el Clearwater Marine Aquarium?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta2" id="respuesta2_si" value="Sí">
                            <label for="respuesta2_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta2" id="respuesta2_no" value="No">
                            <label for="respuesta2_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <label for="respuesta3">3. ¿Podrías mencionar la ciudad específica donde está ubicado este acuario?</label>
                    <input type="text" name="respuesta3" id="respuesta3" class="text-input">
                </div>

                <div class="question-group">
                    <label for="respuesta4">4. ¿Cuál crees que es la misión principal del Clearwater Marine Aquarium?</label>
                    <input type="text" name="respuesta4" id="respuesta4" class="text-input">
                </div>

                <div class="question-group">
                    <label for="respuesta5">5. ¿Sabes si este acuario trabaja con animales rescatados, rehabilitados o liberados?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta5" id="respuesta5_si" value="Sí">
                            <label for="respuesta5_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta5" id="respuesta5_no" value="No">
                            <label for="respuesta5_no">No</label>
                        </div>
                    </div>
                </div>
                
                <div class="question-group">
                    <label for="respuesta6">6. Menciona al menos un animal famoso asociado con este acuario.</label>
                    <input type="text" name="respuesta6" id="respuesta6" class="text-input">
                </div>
                
                <div class="question-group">
                    <label for="respuesta7">7. ¿Conoces la historia de Winter, el delfín que vivió en este acuario?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta7" id="respuesta7_si" value="Sí">
                            <label for="respuesta7_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta7" id="respuesta7_no" value="No">
                            <label for="respuesta7_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <label for="respuesta8">8. ¿Crees que el Clearwater Marine Aquarium funciona igual que un acuario tradicional? ¿Por qué?</label>
                    <input type="text" name="respuesta8" id="respuesta8" class="text-input">
                </div>

                <div class="question-group">
                    <label for="respuesta9">9. ¿Qué tipo de animales marinos crees que se cuidan en el Clearwater Marine Aquarium?</label>
                    <input type="text" name="respuesta9" id="respuesta9" class="text-input">
                </div>

                <div class="question-group">
                    <label for="respuesta10">10. ¿Has visto alguna película o documental inspirado en este acuario?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta10" id="respuesta10_si" value="Sí">
                            <label for="respuesta10_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta10" id="respuesta10_no" value="No">
                            <label for="respuesta10_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <label for="respuesta11">11. ¿Qué piensas que significa "rehabilitación" en el contexto de un acuario de conservación?</label>
                    <input type="text" name="respuesta11" id="respuesta11" class="text-input">
                </div>

                <div class="question-group">
                    <label for="respuesta12">12. ¿Sabes si el acuario permite la liberación de animales al océano una vez rehabilitados?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta12" id="respuesta12_si" value="Sí">
                            <label for="respuesta12_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta12" id="respuesta12_no" value="No">
                            <label for="respuesta12_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <label for="respuesta13">13. ¿Qué importancia crees que tiene este tipo de instituciones para el medio ambiente?</label>
                    <input type="text" name="respuesta13" id="respuesta13" class="text-input">
                </div>

                <div class="question-group">
                    <label for="respuesta14">14. ¿Conoces alguna campaña o proyecto educativo que se realice en el Clearwater Marine Aquarium?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="respuesta14" id="respuesta14_si" value="Sí">
                            <label for="respuesta14_si">Sí</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="respuesta14" id="respuesta14_no" value="No">
                            <label for="respuesta14_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="question-group">
                    <label for="respuesta15">15. En tu opinión, ¿cuál debería ser el rol de un acuario en la conservación de la fauna marina?</label>
                    <input type="text" name="respuesta15" id="respuesta15" class="text-input">
                </div>

                <div class="buttons-container">
                    <input class="button" type="button" name="envio" id="envio" value="Obtener datos" onclick="enviar()">
                    <input class="button" type="button" value="Generar PDF" onclick="generarPDF()">
                </div>
            </form>
        </div>
    </div>
    
    <div class="body" id="datos"></div>
    <div id="pdfContainer">
        <h3>Vista previa del PDF</h3>
        <iframe id="pdfViewer"></iframe>
    </div>

    <script>
        // Función para obtener el valor de un radio button
        function getRadioValue(name) {
            const selected = document.querySelector(`input[name="${name}"]:checked`);
            return selected ? selected.value : 'No respondido';
        }

        // Función para mostrar los datos en la página
        function mostrarDatos() {
            const form = document.forms['formulario'];
            let html = '<h2>Respuestas del cuestionario</h2><ul>';
            
            for (let i = 1; i <= 15; i++) {
                const preguntaElement = form.querySelector(`label[for="respuesta${i}"]`);
                if (!preguntaElement) continue;
                
                const pregunta = preguntaElement.textContent;
                let respuesta;
                
                if ([1, 2, 5, 7, 10, 12, 14].includes(i)) {
                    respuesta = getRadioValue(`respuesta${i}`);
                } else {
                    const input = form.elements[`respuesta${i}`];
                    respuesta = input ? (input.value || 'No respondido') : 'No respondido';
                }
                
                html += `<li><strong>${pregunta}</strong><br>${respuesta}</li>`;
            }
            
            html += '</ul>';
            document.getElementById('datos').innerHTML = html;
        }

        // Función para generar el PDF
        function generarPDF() {
            try {
                // Verificamos que jsPDF esté disponible
                if (typeof window.jspdf === 'undefined') {
                    throw new Error('La biblioteca jsPDF no se cargó correctamente');
                }

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Configuración del documento
                doc.setFontSize(20);
                doc.setTextColor(40, 80, 120);
                doc.text('Respuestas del Cuestionario', 105, 20, { align: 'center' });
                
                doc.setFontSize(12);
                doc.setTextColor(0, 0, 0);
                
                const form = document.forms['formulario'];
                let yPosition = 30;
                
                // Recorrer todas las preguntas
                for (let i = 1; i <= 15; i++) {
                    const preguntaElement = form.querySelector(`label[for="respuesta${i}"]`);
                    if (!preguntaElement) continue;
                    
                    const pregunta = preguntaElement.textContent;
                    let respuesta;
                    
                    if ([1, 2, 5, 7, 10, 12, 14].includes(i)) {
                        respuesta = getRadioValue(`respuesta${i}`);
                    } else {
                        const input = form.elements[`respuesta${i}`];
                        respuesta = input ? (input.value || 'No respondido') : 'No respondido';
                    }
                    
                    // Agregar pregunta al PDF
                    doc.setFont('helvetica', 'bold');
                    const preguntaLines = doc.splitTextToSize(pregunta, 180);
                    doc.text(preguntaLines, 5, yPosition);
                    
                    // Agregar respuesta al PDF
                    doc.setFont('helvetica', 'normal');
                    const splitRespuesta = doc.splitTextToSize(respuesta, 180);
                    doc.text(splitRespuesta, 20, yPosition + 11);//posicion de la respuesta
                    
                    yPosition += 5 + (splitRespuesta.length * 7) + 8;//distancia entre cada pregunta
                    
                    // Verificar si necesitamos una nueva página
                    if (yPosition > 270 && i < 15) {
                        doc.addPage();
                        yPosition = 20;
                    }
                }
                
                // Mostrar el PDF en la página
                const pdfDataUri = doc.output('datauristring');
                document.getElementById('pdfViewer').src = pdfDataUri;
                document.getElementById('pdfContainer').style.display = 'block';
                
                // Descargar automáticamente
                doc.save('respuestas_encuesta.pdf');
                
            } catch (error) {
                console.error('Error al generar PDF:', error);
                alert('Error al generar PDF: ' + error.message);
            }
        }
    </script>
</body>
</html>